webpackJsonp([6],{curo:function(l,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=t("WT6e"),u=function(){},i=t("/TV/"),o=t("Xjw4"),r=function(){},a=function(){function l(){}return l.prototype.ngOnInit=function(){this.isPlanEmpty=void 0===this.plan.productTypeId,this.width=90*this.plan.duration/24,this.color=this.isPlanEmpty?"grey":this.plan.isImportant?"#de3163":"white"},l}(),d=e["\u0275crt"]({encapsulation:0,styles:[[".bordered[_ngcontent-%COMP%]{border:1px solid #000;border-left:none}strong[_ngcontent-%COMP%]{font-size:.7rem}div.overflow-text[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}"]],data:{}});function s(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,5,"div",[["class","text-center overflow-text"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](2,0,null,null,2,"strong",[],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["",": ",""])),e["\u0275ppd"](4,1),(l()(),e["\u0275ted"](-1,null,["\n        "]))],null,function(l,n){var t=n.component;l(n,3,0,t.plan.productType.name,e["\u0275unv"](n,3,1,l(n,4,0,e["\u0275nov"](n.parent,0),t.plan.productAmount)))})}function c(l){return e["\u0275vid"](0,[e["\u0275pid"](0,i.a,[]),(l()(),e["\u0275eld"](1,0,null,null,6,"div",[["class","h-100 bordered d-flex flex-column justify-content-center px-1"]],null,null,null,null,null)),e["\u0275did"](2,278528,null,0,o.NgStyle,[e.KeyValueDiffers,e.ElementRef,e.Renderer2],{ngStyle:[0,"ngStyle"]},null),e["\u0275pod"](3,{width:0,"background-color":1}),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275and"](16777216,null,null,1,null,s)),e["\u0275did"](6,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,2,0,l(n,3,0,t.width+"vw",t.color)),l(n,6,0,!t.isPlanEmpty)},null)}var p=function(){function l(){}return l.prototype.ngOnInit=function(){},l}(),m=e["\u0275crt"]({encapsulation:0,styles:[[".filled-circle[_ngcontent-%COMP%]{padding:0 .5rem;border-width:.04rem;font-size:12px}"]],data:{}});function f(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,6,"div",[],null,null,null,null,null)),(l()(),e["\u0275ted"](1,null,["\n    ","\xa0\n    "])),(l()(),e["\u0275eld"](2,0,null,null,3,"i",[["class","filled-circle"]],null,null,null,null,null)),e["\u0275did"](3,278528,null,0,o.NgStyle,[e.KeyValueDiffers,e.ElementRef,e.Renderer2],{ngStyle:[0,"ngStyle"]},null),e["\u0275pod"](4,{"background-color":0}),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](6,null,["\n    \xa0"," - ","\n"]))],function(l,n){l(n,3,0,l(n,4,0,n.component.rollType.colorCode))},function(l,n){var t=n.component;l(n,1,0,t.rollType.thickness),l(n,6,0,t.rollType.minWeight,t.rollType.maxWeight)})}function h(l){return e["\u0275vid"](0,[(l()(),e["\u0275and"](16777216,null,null,1,null,f)),e["\u0275did"](1,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(l,n){l(n,1,0,n.component.rollType)},null)}var g=function(){function l(){}return l.prototype.ngOnInit=function(){},l}(),v=e["\u0275crt"]({encapsulation:0,styles:[[".filled-circle[_ngcontent-%COMP%]{padding:0 .5rem;border-width:.04rem;font-size:12px}"]],data:{}});function b(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](0,null,[""," \xa0\n"])),(l()(),e["\u0275eld"](1,0,null,null,2,"i",[["class","filled-circle"]],null,null,null,null,null)),e["\u0275did"](2,278528,null,0,o.NgStyle,[e.KeyValueDiffers,e.ElementRef,e.Renderer2],{ngStyle:[0,"ngStyle"]},null),e["\u0275pod"](3,{"background-color":0}),(l()(),e["\u0275ted"](4,null,["\n\xa0 ",""]))],function(l,n){l(n,2,0,l(n,3,0,n.component.productType.colorCode))},function(l,n){var t=n.component;l(n,0,0,t.productType.name),l(n,4,0,t.productType.weight)})}var y=t("YaPU"),C=t("PJh5"),T=t("Gvdl"),I=function(){function l(){this.dailyProductTypesSource=new T.BehaviorSubject([]),this.dailyPlanSource=new T.BehaviorSubject([]),this.standardsSource=new T.BehaviorSubject([]),this.currentDateSource=new T.BehaviorSubject(new Date)}return l.prototype.getDailyPlan=function(){return this.dailyPlanSource.asObservable()},l.prototype.setDailyPlan=function(l){this.dailyPlanSource.next(l)},l.prototype.updateDailyPlan=function(l,n){var t=this.dailyPlanSource.value;l&&(t[t.findIndex(function(n){return n.productTypeId===l.productTypeId})].productToMachinePlane-=l.productAmount),n&&(t[t.findIndex(function(l){return l.productTypeId===n.productTypeId})].productToMachinePlane+=n.productAmount),this.setDailyPlan(t)},l.prototype.equalizeDailyPlan=function(l){var n=this.dailyPlanSource.value,t=n.findIndex(function(n){return n.productTypeId===l.productTypeId});n[t].manufacturedAmount=n[t].productToMachinePlane,this.setDailyPlan(n)},l.prototype.getDailyProductTypes=function(){return this.dailyProductTypesSource.asObservable()},l.prototype.setDailyProductTypes=function(l){this.dailyProductTypesSource.next(l)},l.prototype.getStandards=function(){return this.standardsSource.asObservable()},l.prototype.setStandards=function(l){this.standardsSource.next(l)},l.prototype.getCurrentDate=function(){return this.currentDateSource.asObservable()},l.prototype.setCurrentDate=function(l){this.currentDateSource.next(l)},l}(),S=function(){function l(l){this.dataService=l,this.planRemove=new e.EventEmitter}return l.prototype.ngOnInit=function(){this.standards$=this.dataService.getStandards(),this.tableData$=this.getTableData()},l.prototype.onRemovePlan=function(l){this.planRemove.emit(l)},l.prototype.getTableData=function(){var l=this;return y.a.combineLatest(this.machinePlans$,this.standards$,function(n,t){return n.map(function(n){return l.getTableRow(n,t)})})},l.prototype.getTableRow=function(l,n){var t=C(l.timeStart,"DD-MM-YYYY HH:mm:SS"),e=t.toDate(),u=t.add(l.duration,"hours").toDate();return{plan:l,standard:n.find(function(n){return n.productTypeId===l.productTypeId}),startTime:e,finishTime:u}},l}(),P=e["\u0275crt"]({encapsulation:0,styles:[[".important[_ngcontent-%COMP%]{background-color:#de3163}.mi-sm[_ngcontent-%COMP%]{font-size:18px}.no-borders[_ngcontent-%COMP%]{border:none}table.align-middle[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{vertical-align:middle}.table-fit[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table-fit[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap;width:1%}td[_ngcontent-%COMP%] > .row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline-block;float:none}"]],data:{}});function O(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,7,"div",[["class","row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](2,0,null,null,4,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](4,0,null,null,1,"app-roll-name",[],null,null,null,h,m)),e["\u0275did"](5,114688,null,0,p,[],{rollType:[0,"rollType"]},null),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275ted"](-1,null,["\n              "]))],function(l,n){l(n,5,0,n.context.$implicit.rollType)},null)}function D(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"div",[["class","row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](2,0,null,null,1,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["\n                  ","\n                "])),(l()(),e["\u0275ted"](-1,null,["\n              "]))],null,function(l,n){l(n,3,0,n.context.$implicit.rollAmount)})}function R(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,57,"tr",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](2,0,null,null,3,"td",[],null,null,null,null,null)),e["\u0275did"](3,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{ngClass:[0,"ngClass"]},null),e["\u0275pod"](4,{important:0}),(l()(),e["\u0275ted"](5,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](7,0,null,null,4,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](9,0,null,null,1,"app-product-name",[],null,null,null,b,v)),e["\u0275did"](10,114688,null,0,g,[],{productType:[0,"productType"]},null),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](13,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](14,null,["",""])),e["\u0275ppd"](15,1),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](17,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](18,null,["",""])),e["\u0275ppd"](19,1),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](21,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](22,null,["",""])),e["\u0275ppd"](23,2),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](25,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](26,null,["",""])),e["\u0275ppd"](27,2),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](29,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](30,null,[""," \u0447."])),e["\u0275ppd"](31,2),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](33,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](34,null,["",""])),e["\u0275ppd"](35,1),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](37,0,null,null,4,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275and"](16777216,null,null,1,null,O)),e["\u0275did"](40,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](43,0,null,null,4,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275and"](16777216,null,null,1,null,D)),e["\u0275did"](46,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](49,0,null,null,7,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](51,0,null,null,4,"button",[["class","btn btn-sm btn-outline-danger no-borders"],["style","font-size: 0.6rem"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.onRemovePlan(l.context.$implicit.plan)&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](53,0,null,null,1,"i",[["class","material-icons mi-sm"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["clear"])),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n          "]))],function(l,n){l(n,3,0,l(n,4,0,n.context.$implicit.plan.isImportant)),l(n,10,0,n.context.$implicit.plan.productType),l(n,40,0,n.context.$implicit.plan.planItems),l(n,46,0,n.context.$implicit.plan.planItems)},function(l,n){l(n,5,0,n.context.index+1),l(n,14,0,e["\u0275unv"](n,14,0,l(n,15,0,e["\u0275nov"](n.parent.parent,0),n.context.$implicit.plan.productAmount))),l(n,18,0,e["\u0275unv"](n,18,0,l(n,19,0,e["\u0275nov"](n.parent.parent,0),n.context.$implicit.standard.normForDay))),l(n,22,0,e["\u0275unv"](n,22,0,l(n,23,0,e["\u0275nov"](n.parent.parent,1),n.context.$implicit.startTime,"HH:mm"))),l(n,26,0,e["\u0275unv"](n,26,0,l(n,27,0,e["\u0275nov"](n.parent.parent,1),n.context.$implicit.finishTime,"HH:mm"))),l(n,30,0,e["\u0275unv"](n,30,0,l(n,31,0,e["\u0275nov"](n.parent.parent,2),n.context.$implicit.plan.duration,"1.1-1"))),l(n,34,0,e["\u0275unv"](n,34,0,l(n,35,0,e["\u0275nov"](n.parent.parent,0),n.context.$implicit.standard.norm)))})}function M(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,48,"div",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](2,0,null,null,45,"table",[["class","table table-sm align-top table-fit"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](4,0,null,null,36,"thead",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](6,0,null,null,33,"tr",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](8,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["#"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](11,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044f"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](14,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041a\u043e\u043b-\u0432\u043e"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](17,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041d\u043e\u0440\u043c.\xa0\u0432\u0440\u0435\u043c\u044f"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](20,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041d\u0430\u0447\u0430\u043b\u043e"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](23,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](26,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0414\u043b\u0438\u0442."])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](29,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041d\u043e\u0440\u043c.\xa0\u0440\u0443\u043b\u043e\u043d"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](32,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0420\u0443\u043b\u043e\u043d"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](35,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041a\u043e\u043b-\u0432\u043e"])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](38,0,null,null,0,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](42,0,null,null,4,"tbody",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275and"](16777216,null,null,1,null,R)),e["\u0275did"](45,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "]))],function(l,n){l(n,45,0,n.context.ngIf)},null)}function E(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](1,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."])),(l()(),e["\u0275ted"](-1,null,["\n    "]))],null,null)}function F(l){return e["\u0275vid"](0,[e["\u0275pid"](0,i.a,[]),e["\u0275pid"](0,o.DatePipe,[e.LOCALE_ID]),e["\u0275pid"](0,o.DecimalPipe,[e.LOCALE_ID]),(l()(),e["\u0275eld"](3,0,null,null,10,"div",[["class","row mt-2"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](5,0,null,null,7,"div",[["class","col-8"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275and"](16777216,null,null,2,null,M)),e["\u0275did"](8,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),e["\u0275pid"](131072,o.AsyncPipe,[e.ChangeDetectorRef]),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275and"](0,[["loading",2]],null,0,null,E)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,8,0,e["\u0275unv"](n,8,0,e["\u0275nov"](n,9).transform(t.tableData$)),e["\u0275nov"](n,11))},null)}var _=t("7DMc"),w=t("Hz9/"),N=t("eOWw"),A=function(){function l(){this.change=new e.EventEmitter}return l.prototype.ngOnInit=function(){},l.prototype.onChange=function(){this.change.emit()},l}(),x=e["\u0275crt"]({encapsulation:0,styles:[[".modal.in[_ngcontent-%COMP%]{display:block}.modal.modal-backdrop[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.6)}.modal-body[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}.modal-dialog[_ngcontent-%COMP%]{min-width:42vw}.btn-sm[_ngcontent-%COMP%]{height:2.4rem}.btn-outline[_ngcontent-%COMP%]{border:none}.border-left[_ngcontent-%COMP%]{border-left:1px dashed #333}.input-sm.ng-select[_ngcontent-%COMP%]{margin:0;padding:0}ng-select.no-borders[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border:0;outline:0}.bordered-top[_ngcontent-%COMP%]{border-top:1px solid #ddd;padding-top:.5rem}.bordered-left[_ngcontent-%COMP%]{border-left:2px solid #ddd;padding-left:1rem}"]],data:{}});function V(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](1,0,null,null,1,"app-product-name",[],null,null,null,b,v)),e["\u0275did"](2,114688,null,0,g,[],{productType:[0,"productType"]},null),(l()(),e["\u0275ted"](-1,null,["\n        "]))],function(l,n){l(n,2,0,n.context.item)},null)}function k(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](1,0,null,null,1,"app-product-name",[],null,null,null,b,v)),e["\u0275did"](2,114688,null,0,g,[],{productType:[0,"productType"]},null),(l()(),e["\u0275ted"](-1,null,["\n        "]))],function(l,n){l(n,2,0,n.context.item)},null)}function U(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"span",[["class","invalid-feedback"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](2,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u043e\u0431\u044f\u0437\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"])),(l()(),e["\u0275ted"](-1,null,["\n      "]))],null,null)}function $(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,42,"div",[],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(l,n,t){var u=!0;return"submit"===n&&(u=!1!==e["\u0275nov"](l,1).onSubmit(t)&&u),"reset"===n&&(u=!1!==e["\u0275nov"](l,1).onReset()&&u),u},null,null)),e["\u0275did"](1,540672,null,0,_.FormGroupDirective,[[8,null],[8,null]],{form:[0,"form"]},null),e["\u0275prd"](2048,null,_.ControlContainer,null,[_.FormGroupDirective]),e["\u0275did"](3,16384,null,0,_.NgControlStatusGroup,[_.ControlContainer],null,null),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](5,0,null,null,36,"div",[["class","form-group row my-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](7,0,null,null,1,"label",[["class","col-5 col-form-label"],["for","productType"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0422\u0438\u043f \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438"])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](10,0,null,null,30,"div",[["class","col-7"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](12,0,null,null,24,"ng-select",[["bindValue","id"],["class","form-control input-sm no-borders ng-select"],["id","productType"],["notFoundText","\u0422\u0438\u043f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"],["placeholder","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044e"],["role","listbox"]],[[2,"ng-select-single",null],[2,"ng-select-typeahead",null],[2,"ng-select-multiple",null],[2,"ng-select-taggable",null],[2,"ng-select-searchable",null],[2,"ng-select-opened",null],[2,"ng-select-disabled",null],[2,"ng-select-filtered",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"keydown"]],function(l,n,t){var u=!0,i=l.component;return"keydown"===n&&(u=!1!==e["\u0275nov"](l,15).handleKeyDown(t)&&u),"change"===n&&(u=!1!==i.onChange()&&u),u},w.b,w.a)),e["\u0275did"](13,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e["\u0275pod"](14,{"is-invalid":0}),e["\u0275did"](15,4964352,null,10,N.b,[N.a,[8,"form-control input-sm no-borders"],e.ChangeDetectorRef,N.k,e.NgZone,N.i,e.ElementRef],{items:[0,"items"],bindValue:[1,"bindValue"],placeholder:[2,"placeholder"],notFoundText:[3,"notFoundText"]},{changeEvent:"change"}),e["\u0275qud"](335544320,1,{optionTemplate:0}),e["\u0275qud"](335544320,2,{optgroupTemplate:0}),e["\u0275qud"](335544320,3,{labelTemplate:0}),e["\u0275qud"](335544320,4,{multiLabelTemplate:0}),e["\u0275qud"](335544320,5,{headerTemplate:0}),e["\u0275qud"](335544320,6,{footerTemplate:0}),e["\u0275qud"](335544320,7,{notFoundTemplate:0}),e["\u0275qud"](335544320,8,{typeToSearchTemplate:0}),e["\u0275qud"](335544320,9,{loadingTextTemplate:0}),e["\u0275qud"](603979776,10,{ngOptions:1}),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[N.b]),e["\u0275did"](27,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"]},null),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](29,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275and"](0,[[3,2]],null,1,null,V)),e["\u0275did"](32,16384,null,0,N.e,[e.TemplateRef],null,null),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275and"](0,[[1,2]],null,1,null,k)),e["\u0275did"](35,16384,null,0,N.d,[e.TemplateRef],null,null),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275and"](16777216,null,null,1,null,U)),e["\u0275did"](39,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,1,0,t.formGroup),l(n,13,0,"form-control input-sm no-borders",l(n,14,0,t.formGroup.get("productType").invalid&&t.formGroup.get("productType").touched)),l(n,15,0,t.items,"id","\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044e","\u0422\u0438\u043f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),l(n,27,0,t.formControlName),l(n,39,0,t.formGroup.get("productType").invalid&&t.formGroup.get("productType").touched)},function(l,n){l(n,0,0,e["\u0275nov"](n,3).ngClassUntouched,e["\u0275nov"](n,3).ngClassTouched,e["\u0275nov"](n,3).ngClassPristine,e["\u0275nov"](n,3).ngClassDirty,e["\u0275nov"](n,3).ngClassValid,e["\u0275nov"](n,3).ngClassInvalid,e["\u0275nov"](n,3).ngClassPending),l(n,12,1,[!e["\u0275nov"](n,15).multiple,e["\u0275nov"](n,15).typeahead,e["\u0275nov"](n,15).multiple,e["\u0275nov"](n,15).addTag,e["\u0275nov"](n,15).searchable,e["\u0275nov"](n,15).isOpen,e["\u0275nov"](n,15).isDisabled,e["\u0275nov"](n,15).filtered,e["\u0275nov"](n,29).ngClassUntouched,e["\u0275nov"](n,29).ngClassTouched,e["\u0275nov"](n,29).ngClassPristine,e["\u0275nov"](n,29).ngClassDirty,e["\u0275nov"](n,29).ngClassValid,e["\u0275nov"](n,29).ngClassInvalid,e["\u0275nov"](n,29).ngClassPending])})}var L=t("g5jc"),G=function(){},j=t("BayP"),H=t("J0WG"),W=function(){function l(l,n){this.productService=l,this.rollService=n,this.productTypeCashe=[],this.rollTypeCashe=[]}return l.prototype.getProductType=function(l){var n=this,t=this.productTypeCashe.find(function(n){return n.id===l});return t?T.Observable.of(t):this.productService.getProductType(l).do(function(l){return n.productTypeCashe.push(l)})},l.prototype.getRollType=function(l){var n=this,t=this.rollTypeCashe.find(function(n){return n.id===l});return t?T.Observable.of(t):this.rollService.getRollType(l).do(function(l){return n.rollTypeCashe.push(l)})},l}(),Y=t("gXfh"),q=t("e3U/"),z=function(){function l(l,n,t){this.dataService=l,this.casheService=n,this.productPlanService=t,this.changeData=new e.EventEmitter,this.isLoaded=new e.EventEmitter,this._planItems=[],this.commonRollAmount=0,this.ngUnsubscribe=new L.b,this.tableLoading=!1}return Object.defineProperty(l.prototype,"planItems",{get:function(){return this._planItems},enumerable:!0,configurable:!0}),l.prototype.ngOnInit=function(){var l=this;this.productType$.takeUntil(this.ngUnsubscribe).subscribe(function(n){l.productType=n,l.tableLoading=!0,l.changeData.emit(0),l.isLoaded.emit(!1)}),this.getTableData(this.productType$).takeUntil(this.ngUnsubscribe).subscribe(function(n){l.setInitAmount(n),l.tableLoading=!1,l.tableData=n,l.isLoaded.emit(!0)}),this.getStandard(this.productType$).takeUntil(this.ngUnsubscribe).subscribe(function(n){return l.standard=n})},l.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},l.prototype.onChange=function(l){var n=this.rollAmountInputs.toArray()[l],t=Number.parseInt(n.nativeElement.value);t=t>0?Math.round(t):0,n.nativeElement.value=t;var e=this._planItems[l].rollAmount;this._planItems[l].rollAmount=t,this._planItems[l].productAmount=t*this.standard.norm,this.commonRollAmount=this.commonRollAmount-e+t,this.changeData.emit(this.commonRollAmount*this.standard.norm)},l.prototype.getCurrentAmount=function(l){var n=this.current.productTypeId&&this.current.productTypeId===this.productType.id?l.item.rollAmount:l.operation.rollAmount-l.operation.rollToMachinePlane;return n>0?n:0},l.prototype.getDiff=function(l,n){var t=l-n;return t>0?t:0},l.prototype.setInitAmount=function(l){var n=this;this._planItems=[],this.commonRollAmount=0;var t=0;null!==l&&(l.forEach(function(l){var t=n.getCurrentAmount(l);n.commonRollAmount+=t;var e=new G;e.rollType=l.roll,e.rollAmount=t,e.productAmount=t*n.standard.norm,n._planItems.push(e)}),t=this.commonRollAmount*this.standard.norm),this.changeData.emit(t)},l.prototype.getStandard=function(l){var n=this;return l.flatMap(function(l){var t=n.dataService.getStandards().map(function(n){return n.find(function(n){return n.productTypeId===l.id})});return l?t:y.a.of(null)})},l.prototype.getRollTypes=function(l){var n=this;return this.getStandard(l).flatMap(function(l){return 0===l.rollTypeIds.length?y.a.of([]):y.a.forkJoin(l.rollTypeIds.map(function(l){return n.casheService.getRollType(l)}))})},l.prototype.getOperations=function(l){var n=this;return y.a.combineLatest(this.dataService.getCurrentDate(),l).flatMap(function(l){return n.productPlanService.getOperationsByProduct(l[1].id,Object(q.c)(l[0]),Object(q.c)(l[0]))})},l.prototype.getTableData=function(l){var n=this,t=y.a.combineLatest(this.getRollTypes(l),this.getOperations(l),function(l,t){return 0!==l.length?l.map(function(l){return n.getTableRow(l,t)}):[]});return l.switchMap(function(l){return l?t:y.a.of(null)})},l.prototype.getTableRow=function(l,n){var t=this.current.productTypeId&&this.current.productTypeId===this.productType.id?this.current.planItems.find(function(n){return n.rollTypeId===l.id}):null,e=n.find(function(n){return n.rollTypeId===l.id}),u={date:null,productTypeId:null,rollTypeId:l.id,rollAmount:0,productAmount:0,rollToMachinePlane:0},i=new G;return i.rollAmount=0,i.productAmount=0,{roll:l,operation:e||u,item:t||i}},l}(),J=e["\u0275crt"]({encapsulation:0,styles:[[""]],data:{}});function B(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,22,"div",[["class","row d-flex mt-1"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](2,0,null,null,4,"div",[["class","col-5 align-self-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](4,0,null,null,1,"app-roll-name",[],null,null,null,h,m)),e["\u0275did"](5,114688,null,0,p,[],{rollType:[0,"rollType"]},null),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](8,0,null,null,3,"div",[["class","col-3 align-self-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](10,0,[[1,0],["rollAmount",1]],null,0,"input",[["class","form-control"],["min","0"],["type","number"]],[[8,"value",0]],[[null,"change"]],function(l,n,t){var e=!0;return"change"===n&&(e=!1!==l.component.onChange(l.context.index)&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](13,0,null,null,3,"div",[["class","col-2 align-self-center bordered-left"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](15,0,null,null,0,"input",[["class","form-control"],["readonly",""],["type","text"]],[[8,"value",0]],null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](18,0,null,null,3,"div",[["class","col-2 align-self-center bordered-left"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](20,0,null,null,0,"input",[["class","form-control"],["readonly",""],["type","text"]],[[8,"value",0]],null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "]))],function(l,n){l(n,5,0,n.context.$implicit.roll)},function(l,n){var t=n.component;l(n,10,0,e["\u0275inlineInterpolate"](1,"",t.getCurrentAmount(n.context.$implicit),"")),l(n,15,0,e["\u0275inlineInterpolate"](1,"",t.getDiff(n.context.$implicit.operation.rollToMachinePlane,n.context.$implicit.item.rollAmount),"")),l(n,20,0,e["\u0275inlineInterpolate"](1,"",n.context.$implicit.operation.rollAmount,""))})}function K(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,17,"div",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](2,0,null,null,14,"div",[["id","rolls-container"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](4,0,null,null,8,"div",[["class","row bordered-top my-2"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](6,0,null,null,5,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](8,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](9,null,["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0443\u043b\u043e\u043d\u043e\u0432 (\u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432 - "," \u0442\u044b\u0441.\u0448\u0442. / \u0440\u0443\u043b.)"])),e["\u0275ppd"](10,1),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275and"](16777216,null,null,1,null,B)),e["\u0275did"](15,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n  "]))],function(l,n){l(n,15,0,n.component.tableData)},function(l,n){var t=n.component;l(n,9,0,e["\u0275unv"](n,9,0,l(n,10,0,e["\u0275nov"](n.parent.parent,0),t.standard.norm)))})}function X(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](1,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."])),(l()(),e["\u0275ted"](-1,null,["\n  "]))],null,null)}function Z(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,6,"div",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275and"](16777216,null,null,1,null,K)),e["\u0275did"](3,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275and"](0,[["loading",2]],null,0,null,X)),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){l(n,3,0,!n.component.tableLoading,e["\u0275nov"](n,5))},null)}function Q(l){return e["\u0275vid"](0,[e["\u0275pid"](0,i.a,[]),e["\u0275qud"](671088640,1,{rollAmountInputs:1}),(l()(),e["\u0275and"](16777216,null,null,2,null,Z)),e["\u0275did"](3,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),e["\u0275pid"](131072,o.AsyncPipe,[e.ChangeDetectorRef])],function(l,n){var t=n.component;l(n,3,0,e["\u0275unv"](n,3,0,e["\u0275nov"](n,4).transform(t.productType$)))},null)}var ll=function(){function l(l){this.dataService=l,this.DATE_TIME_FORMAT="DD-MM-YYYY HH:mm:SS",this.TIME_FORMAT="HH:mm",this.machineRestMinutes=30,this.cancel=new e.EventEmitter,this.submit=new e.EventEmitter,this.isUpdating=!1,this.currentPlanOperations=[],this.isFetched=!1,this.isTable=!1,this.isTableLoaded=!1,this.productTypeSubject=new T.BehaviorSubject(null),this.productType$=this.productTypeSubject.asObservable(),this.ngUnsubscribe=new T.Subject}return l.prototype.ngOnInit=function(){var l=this;T.Observable.combineLatest(this.dataService.getCurrentDate(),this.dataService.getStandards(),this.dataService.getDailyProductTypes(),this.machinePlans$).takeUntil(this.ngUnsubscribe).subscribe(function(n){l.date=n[0],l.standards=n[1],l.dailyProductTypes=n[2],l.machinePlans=n[3],l.initData(),l.initForm(),l.isFetched=!0})},l.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},l.prototype.onSubmit=function(){var l=this.getPlan();this.submit.emit(l)},l.prototype.onCancel=function(){this.cancel.emit()},l.prototype.initData=function(){this.current=this.machinePlans[this.currentIndex],this.before=0!==this.currentIndex?this.machinePlans[this.currentIndex-1]:null,this.after=this.currentIndex!==this.machinePlans.length-1?this.machinePlans[this.currentIndex+1]:null,this.isUpdating=void 0!==this.current.productTypeId;var l=C(this.date).startOf("days").add(8,"hours").toDate(),n=C(this.date).endOf("days").add(8,"hours").toDate();this.minTime=this.before?this.isUpdating?this.getTime(this.before.timeStart):this.getTime(this.before.timeStart,this.before.duration):l,this.maxTime=this.after?this.isUpdating?this.getTime(this.getTime(this.current.timeStart,this.current.duration),this.after.duration):this.getTime(this.after.timeStart):n,this.currentStartTime=this.isUpdating?this.getTime(this.current.timeStart):this.minTime,this.currentFinishTime=this.isUpdating?this.getTime(this.current.timeStart,this.current.duration):this.currentStartTime,this.currentAmount=this.current?this.current.productAmount:0;var t=this.isUpdating?this.current.productType:null;this.productTypeSubject.next(t),this.currentStandard=t?this.standards.find(function(l){return l.productTypeId===t.id}):null,this.validateStartTime(),this.validateFinishTime()},l.prototype.initForm=function(){var l=this.isUpdating?this.current.productTypeId:null;this.planForm=new _.FormGroup({important:new _.FormControl(!!this.isUpdating&&this.current.isImportant),productType:new _.FormControl(l,[_.Validators.required]),startTime:new _.FormControl(this.currentStartTime),startChange:new _.FormControl(this.machineRestMinutes),finishTime:new _.FormControl(this.currentFinishTime),amount:new _.FormControl(this.currentAmount,[_.Validators.required,_.Validators.min(0)])})},l.prototype.getPlan=function(){var l=this.planForm.value,n=l.productType,t=l.important,e=new r;return e.id=this.isUpdating?this.current.id:null,e.machineNumber=this.machineNumber,e.productTypeId=n,e.timeStart=C(this.currentStartTime).format(this.DATE_TIME_FORMAT),e.isImportant=t,e.planItems=this.getPlanItems(),e},l.prototype.getPlanItems=function(){var l=this;return this.rollTable.planItems.filter(function(l){return l.rollAmount>0}).map(function(n){var t=l.isUpdating?l.current.planItems.find(function(l){return l.rollTypeId===n.rollType.id}):null,e=new G;return e.id=t?t.id:null,e.rollTypeId=n.rollType.id,e.rollAmount=n.rollAmount,e.productAmount=n.productAmount,e})},l.prototype.setProductType=function(){var l=this.planForm.value.productType,n=l?this.dailyProductTypes.find(function(n){return n.id===l}):null;this.productTypeSubject.next(n),this.currentStandard=n?this.standards.find(function(l){return l.productTypeId===n.id}):null},l.prototype.updateAmount=function(l){this.currentAmount=l,this.updateFinishTime()},l.prototype.updateFinishTime=function(){this.currentFinishTime=this.currentStandard?this.getTime(this.currentStartTime,this.currentAmount/(this.currentStandard.normForDay/24)):this.currentStartTime,this.validateFinishTime()},l.prototype.updateStartTime=function(){var l=this.planForm.value.startTime;if(l){var n=C(l,this.TIME_FORMAT),t=n.get("hour")<8?1:0;this.currentStartTime=C(this.date).startOf("day").add(n.get("hour"),"hours").add(n.get("minute"),"minutes").add(t,"days").toDate()}else this.currentStartTime=this.minTime,this.planForm.get("startTime").setValue(C(this.minTime).format(this.TIME_FORMAT));this.validateStartTime(),this.updateFinishTime()},l.prototype.changeCurrentStartTime=function(){var l=this.planForm.value,n=l.startChange,t=C(l.startTime,this.TIME_FORMAT).add(n,"minutes").format(this.TIME_FORMAT);this.planForm.get("startTime").setValue(t),this.updateStartTime()},l.prototype.getTime=function(l,n){void 0===n&&(n=0);var t=l instanceof Date?C(l):C(l,this.DATE_TIME_FORMAT);return t.add(n,"hours"),t.toDate()},l.prototype.getDateTimeDiffMinutes=function(l,n){return Math.round((n.valueOf()-l.valueOf())/1e3/60)},l.prototype.getDateTimeDiff=function(l,n){return(n.valueOf()-l.valueOf())/1e3},l.prototype.validateStartTime=function(){this.startTimeError=null,this.startTimeWarning=null;var l=this.getDateTimeDiffMinutes(this.minTime,this.currentStartTime);this.startTimeError=l<0?"\u0432\u0440\u0435\u043c\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0432\u044b\u0445\u043e\u0434\u0438\u0442 \u0437\u0430 \u0433\u0440\u0430\u043d\u0438\u0446\u044b \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0435\u0440\u0438\u043e\u0434\u0430":null,this.startTimeWarning=l<this.machineRestMinutes&&l>=0&&this.before&&!this.isDayStart(this.minTime)?"\u043f\u0435\u0440\u0435\u0440\u044b\u0432 \u043c\u0435\u0436\u0434\u0443 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u043c \u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u043c \u043f\u043b\u0430\u043d\u0430\u043c\u0438 \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 "+l+" \u043c\u0438\u043d.":null},l.prototype.validateFinishTime=function(){this.finishTimeError=null,this.finishTimeWarning=null;var l=this.getDateTimeDiff(this.currentFinishTime,this.maxTime),n=this.getDateTimeDiffMinutes(this.currentFinishTime,this.maxTime);this.finishTimeError=l<0?"\u0432\u0440\u0435\u043c\u044f \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0432\u044b\u0445\u043e\u0434\u0438\u0442 \u0437\u0430 \u0433\u0440\u0430\u043d\u0438\u0446\u044b \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u0435\u0440\u0438\u043e\u0434\u0430":null,this.finishTimeWarning=n<this.machineRestMinutes&&l>=0&&this.after&&!this.isDayEnd(this.maxTime)?"\u043f\u0435\u0440\u0435\u0440\u044b\u0432 \u043c\u0435\u0436\u0434\u0443 \u0442\u0435\u043a\u0443\u0449\u0438\u043c \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043f\u043b\u0430\u043d\u0430\u043c\u0438 \u0441\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 "+n+" \u043c\u0438\u043d.":null},l.prototype.isProductTypeSelectedValid=function(){return!this.planForm.hasError("required",["productType"])},l.prototype.isFormValid=function(){return!this.startTimeError&&!this.finishTimeError&&this.isProductTypeSelectedValid()&&this.currentAmount>0},l.prototype.isDayStart=function(l){var n=C(this.date).startOf("days").add(8,"hours");return C(l).isSame(n)},l.prototype.isDayEnd=function(l){var n=C(this.date).endOf("days").add(8,"hours");return C(l).isSame(n)},l}(),nl=e["\u0275crt"]({encapsulation:0,styles:[[".modal.in[_ngcontent-%COMP%]{display:block}.modal.modal-backdrop[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.6)}.modal-body[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}.modal-dialog[_ngcontent-%COMP%]{min-width:42vw}.btn-sm[_ngcontent-%COMP%]{height:2.4rem}.btn-outline[_ngcontent-%COMP%]{border:none}.border-left[_ngcontent-%COMP%]{border-left:1px dashed #333}.input-sm.ng-select[_ngcontent-%COMP%]{margin:0;padding:0}ng-select.no-borders[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{border:0;outline:0}.filled-circle[_ngcontent-%COMP%]{padding:0 .5rem;border-width:.04rem;font-size:12px}.bordered-top[_ngcontent-%COMP%]{border-top:1px solid #ddd;padding-top:.5rem}.bordered-left[_ngcontent-%COMP%]{border-left:2px solid #ddd;padding-left:1rem}.custom-checkbox[_ngcontent-%COMP%]{-webkit-transform:scale(1.3);transform:scale(1.3)}"]],data:{}});function tl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,1,"h4",[["class","modal-title"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043b\u0430\u043d"]))],null,null)}function el(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,1,"h4",[["class","modal-title"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043b\u0430\u043d"]))],null,null)}function ul(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"span",[["class","invalid-feedback"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](2,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u043a\u043e\u043b-\u0432\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 0"])),(l()(),e["\u0275ted"](-1,null,["\n                "]))],null,null)}function il(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](1,null,["(\u043d\u043e\u0440\u043c\u0430\u0442\u0438\u0432 - "," \u0442\u044b\u0441.\u0448\u0442. / \u0434\u0435\u043d\u044c)"])),e["\u0275ppd"](2,1)],null,function(l,n){var t=n.component;l(n,1,0,e["\u0275unv"](n,1,0,l(n,2,0,e["\u0275nov"](n.parent.parent,0),t.currentStandard.normForDay)))})}function ol(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"div",[["class","alert alert-warning text-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](2,0,null,null,1,"small",[],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n                "]))],null,function(l,n){l(n,3,0,n.component.startTimeWarning)})}function rl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"div",[["class","alert alert-danger text-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](2,0,null,null,1,"small",[],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n                "]))],null,function(l,n){l(n,3,0,n.component.startTimeError)})}function al(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"div",[["class","alert alert-warning text-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](2,0,null,null,1,"small",[],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n                "]))],null,function(l,n){l(n,3,0,n.component.finishTimeWarning)})}function dl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"div",[["class","alert alert-danger text-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](2,0,null,null,1,"small",[],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n                "]))],null,function(l,n){l(n,3,0,n.component.finishTimeError)})}function sl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,184,"div",[["class","modal-content"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](2,0,null,null,7,"div",[["class","modal-header"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275and"](16777216,null,null,1,null,tl)),e["\u0275did"](5,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275and"](16777216,null,null,1,null,el)),e["\u0275did"](8,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](11,0,null,null,163,"div",[["class","modal-body"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](13,0,null,null,160,"div",[["class","container"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](15,0,null,null,157,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(l,n,t){var u=!0;return"submit"===n&&(u=!1!==e["\u0275nov"](l,17).onSubmit(t)&&u),"reset"===n&&(u=!1!==e["\u0275nov"](l,17).onReset()&&u),u},null,null)),e["\u0275did"](16,16384,null,0,_["\u0275bf"],[],null,null),e["\u0275did"](17,540672,null,0,_.FormGroupDirective,[[8,null],[8,null]],{form:[0,"form"]},null),e["\u0275prd"](2048,null,_.ControlContainer,null,[_.FormGroupDirective]),e["\u0275did"](19,16384,null,0,_.NgControlStatusGroup,[_.ControlContainer],null,null),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](21,0,null,null,14,"div",[["class","form-check row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](23,0,null,null,11,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](25,0,null,null,5,"input",[["class","form-check-input custom-checkbox"],["formControlName","important"],["id","important"],["type","checkbox"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"blur"]],function(l,n,t){var u=!0;return"change"===n&&(u=!1!==e["\u0275nov"](l,26).onChange(t.target.checked)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,26).onTouched()&&u),u},null,null)),e["\u0275did"](26,16384,null,0,_.CheckboxControlValueAccessor,[e.Renderer2,e.ElementRef],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[_.CheckboxControlValueAccessor]),e["\u0275did"](28,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"]},null),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](30,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](32,0,null,null,1,"label",[["class","form-check-label"],["for","important"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u043f\u043b\u0430\u043d \u0432\u0430\u0436\u0435\u043d"])),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](37,0,null,null,16,"div",[["class","form-group row my-2 bordered-top"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](39,0,null,null,13,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](41,0,null,null,10,"app-product-select",[["formControlName","productType"],["ngDefaultControl",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"submit"],[null,"reset"]],function(l,n,t){var u=!0,i=l.component;return"input"===n&&(u=!1!==e["\u0275nov"](l,42)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,42).onTouched()&&u),"compositionstart"===n&&(u=!1!==e["\u0275nov"](l,42)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e["\u0275nov"](l,42)._compositionEnd(t.target.value)&&u),"submit"===n&&(u=!1!==e["\u0275nov"](l,47).onSubmit(t)&&u),"reset"===n&&(u=!1!==e["\u0275nov"](l,47).onReset()&&u),"change"===n&&(u=!1!==i.setProductType()&&u),u},$,x)),e["\u0275did"](42,16384,null,0,_.DefaultValueAccessor,[e.Renderer2,e.ElementRef,[2,_.COMPOSITION_BUFFER_MODE]],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[_.DefaultValueAccessor]),e["\u0275did"](44,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"]},null),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](46,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),e["\u0275did"](47,540672,null,0,_.FormGroupDirective,[[8,null],[8,null]],{form:[0,"form"]},null),e["\u0275prd"](2048,null,_.ControlContainer,null,[_.FormGroupDirective]),e["\u0275did"](49,16384,null,0,_.NgControlStatusGroup,[_.ControlContainer],null,null),e["\u0275did"](50,114688,null,0,A,[],{items:[0,"items"],formGroup:[1,"formGroup"],formControlName:[2,"formControlName"]},{change:"change"}),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](55,0,null,null,2,"app-roll-table",[],null,[[null,"changeData"],[null,"isLoaded"]],function(l,n,t){var e=!0,u=l.component;return"changeData"===n&&(e=!1!==u.updateAmount(t)&&e),"isLoaded"===n&&(e=!1!==(u.isTableLoaded=t)&&e),e},Q,J)),e["\u0275did"](56,245760,[[1,4],["rollTable",4]],0,z,[I,W,Y.a],{productType$:[0,"productType$"],current:[1,"current"]},{changeData:"changeData",isLoaded:"isLoaded"}),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](59,0,null,null,22,"div",[["class","form-group row my-2 bordered-top"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](61,0,null,null,1,"label",[["class","col-5 col-form-label"],["for","amount"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438"])),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](64,0,null,null,16,"div",[["class","col-7"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](66,0,null,null,9,"input",[["class","form-control"],["formControlName","amount"],["id","amount"],["readonly",""],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0;return"input"===n&&(u=!1!==e["\u0275nov"](l,70)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,70).onTouched()&&u),"compositionstart"===n&&(u=!1!==e["\u0275nov"](l,70)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e["\u0275nov"](l,70)._compositionEnd(t.target.value)&&u),u},null,null)),e["\u0275did"](67,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e["\u0275pid"](131072,o.AsyncPipe,[e.ChangeDetectorRef]),e["\u0275pod"](69,{"is-invalid":0}),e["\u0275did"](70,16384,null,0,_.DefaultValueAccessor,[e.Renderer2,e.ElementRef,[2,_.COMPOSITION_BUFFER_MODE]],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[_.DefaultValueAccessor]),e["\u0275did"](72,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"],model:[1,"model"]},null),e["\u0275ppd"](73,1),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](75,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275and"](16777216,null,null,2,null,ul)),e["\u0275did"](78,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),e["\u0275pid"](131072,o.AsyncPipe,[e.ChangeDetectorRef]),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](83,0,null,null,70,"div",[["class","form-group row bordered-top pt-2 mb-0 d-flex"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](85,0,null,null,67,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](87,0,null,null,7,"div",[["class","row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](89,0,null,null,4,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                      \u0412\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u043d\u0430\n                      "])),(l()(),e["\u0275and"](16777216,null,null,1,null,il)),e["\u0275did"](92,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275eld"](96,0,null,null,55,"div",[["class","row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275eld"](98,0,null,null,14,"div",[["class","col-4 pr-1"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275eld"](100,0,null,null,1,"label",[["class","col-form-label"],["for","startTime"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041d\u0430\u0447\u0430\u043b\u043e"])),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275eld"](103,0,null,null,8,"input",[["class","form-control"],["formControlName","startTime"],["type","time"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"change"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0,i=l.component;return"input"===n&&(u=!1!==e["\u0275nov"](l,106)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,106).onTouched()&&u),"compositionstart"===n&&(u=!1!==e["\u0275nov"](l,106)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e["\u0275nov"](l,106)._compositionEnd(t.target.value)&&u),"change"===n&&(u=!1!==i.updateStartTime()&&u),u},null,null)),e["\u0275did"](104,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e["\u0275pod"](105,{"is-invalid":0}),e["\u0275did"](106,16384,null,0,_.DefaultValueAccessor,[e.Renderer2,e.ElementRef,[2,_.COMPOSITION_BUFFER_MODE]],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[_.DefaultValueAccessor]),e["\u0275did"](108,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"],model:[1,"model"]},null),e["\u0275ppd"](109,2),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](111,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275eld"](114,0,null,null,7,"div",[["class","col-1 align-self-end mx-0 px-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275eld"](116,0,null,null,4,"button",[["class","btn btn-outline-secondary btn-sm btn-outline"],["type","button"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.changeCurrentStartTime()&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n                        "])),(l()(),e["\u0275eld"](118,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["add"])),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275eld"](123,0,null,null,9,"div",[["class","col-2 align-self-end pl-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275eld"](125,0,null,null,6,"input",[["class","form-control"],["formControlName","startChange"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(l,n,t){var u=!0;return"input"===n&&(u=!1!==e["\u0275nov"](l,126)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,126).onTouched()&&u),"compositionstart"===n&&(u=!1!==e["\u0275nov"](l,126)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e["\u0275nov"](l,126)._compositionEnd(t.target.value)&&u),"change"===n&&(u=!1!==e["\u0275nov"](l,127).onChange(t.target.value)&&u),"input"===n&&(u=!1!==e["\u0275nov"](l,127).onChange(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,127).onTouched()&&u),u},null,null)),e["\u0275did"](126,16384,null,0,_.DefaultValueAccessor,[e.Renderer2,e.ElementRef,[2,_.COMPOSITION_BUFFER_MODE]],null,null),e["\u0275did"](127,16384,null,0,_["\u0275bc"],[e.Renderer2,e.ElementRef],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l,n){return[l,n]},[_.DefaultValueAccessor,_["\u0275bc"]]),e["\u0275did"](129,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"]},null),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](131,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275eld"](134,0,null,null,0,"div",[["class","col-1"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                    "])),(l()(),e["\u0275eld"](136,0,null,null,14,"div",[["class","col-4"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275eld"](138,0,null,null,1,"label",[["class","col-form-label"],["for","finishTime"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435"])),(l()(),e["\u0275ted"](-1,null,["\n                      "])),(l()(),e["\u0275eld"](141,0,null,null,8,"input",[["class","form-control"],["formControlName","finishTime"],["readonly",""],["type","time"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0;return"input"===n&&(u=!1!==e["\u0275nov"](l,144)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,144).onTouched()&&u),"compositionstart"===n&&(u=!1!==e["\u0275nov"](l,144)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e["\u0275nov"](l,144)._compositionEnd(t.target.value)&&u),u},null,null)),e["\u0275did"](142,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e["\u0275pod"](143,{"is-invalid":0}),e["\u0275did"](144,16384,null,0,_.DefaultValueAccessor,[e.Renderer2,e.ElementRef,[2,_.COMPOSITION_BUFFER_MODE]],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[_.DefaultValueAccessor]),e["\u0275did"](146,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"],model:[1,"model"]},null),e["\u0275ppd"](147,2),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](149,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n                  "])),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](155,0,null,null,16,"div",[["class","from-group row pt-2"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275eld"](157,0,null,null,13,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275and"](16777216,null,null,1,null,ol)),e["\u0275did"](160,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275and"](16777216,null,null,1,null,rl)),e["\u0275did"](163,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275and"](16777216,null,null,1,null,al)),e["\u0275did"](166,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n                "])),(l()(),e["\u0275and"](16777216,null,null,1,null,dl)),e["\u0275did"](169,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](176,0,null,null,7,"div",[["class","modal-footer"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](178,0,null,null,1,"button",[["class","btn btn-outline-dark"]],[[8,"disabled",0]],[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.onSubmit()&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](181,0,null,null,1,"button",[["class","btn btn-outline-dark"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.onCancel()&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\u041e\u0442\u043c\u0435\u043d\u0430"])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "]))],function(l,n){var t=n.component;l(n,5,0,!t.isUpdating),l(n,8,0,t.isUpdating),l(n,17,0,t.planForm),l(n,28,0,"important"),l(n,44,0,"productType"),l(n,47,0,t.planForm),l(n,50,0,t.dailyProductTypes,t.planForm,"productType"),l(n,56,0,t.productType$,t.current),l(n,67,0,"form-control",l(n,69,0,!t.currentAmount&&e["\u0275unv"](n,67,1,e["\u0275nov"](n,68).transform(t.productType$))&&t.isTableLoaded)),l(n,72,0,"amount",e["\u0275unv"](n,72,1,l(n,73,0,e["\u0275nov"](n.parent,0),t.currentAmount))),l(n,78,0,!t.currentAmount&&e["\u0275unv"](n,78,0,e["\u0275nov"](n,79).transform(t.productType$))&&t.isTableLoaded),l(n,92,0,t.currentStandard),l(n,104,0,"form-control",l(n,105,0,t.startTimeError)),l(n,108,0,"startTime",e["\u0275unv"](n,108,1,l(n,109,0,e["\u0275nov"](n.parent,1),t.currentStartTime,"HH:mm"))),l(n,129,0,"startChange"),l(n,142,0,"form-control",l(n,143,0,t.finishTimeError)),l(n,146,0,"finishTime",e["\u0275unv"](n,146,1,l(n,147,0,e["\u0275nov"](n.parent,1),t.currentFinishTime,"HH:mm"))),l(n,160,0,t.startTimeWarning),l(n,163,0,t.startTimeError),l(n,166,0,t.finishTimeWarning),l(n,169,0,t.finishTimeError)},function(l,n){var t=n.component;l(n,15,0,e["\u0275nov"](n,19).ngClassUntouched,e["\u0275nov"](n,19).ngClassTouched,e["\u0275nov"](n,19).ngClassPristine,e["\u0275nov"](n,19).ngClassDirty,e["\u0275nov"](n,19).ngClassValid,e["\u0275nov"](n,19).ngClassInvalid,e["\u0275nov"](n,19).ngClassPending),l(n,25,0,e["\u0275nov"](n,30).ngClassUntouched,e["\u0275nov"](n,30).ngClassTouched,e["\u0275nov"](n,30).ngClassPristine,e["\u0275nov"](n,30).ngClassDirty,e["\u0275nov"](n,30).ngClassValid,e["\u0275nov"](n,30).ngClassInvalid,e["\u0275nov"](n,30).ngClassPending),l(n,41,1,[e["\u0275nov"](n,46).ngClassUntouched,e["\u0275nov"](n,46).ngClassTouched,e["\u0275nov"](n,46).ngClassPristine,e["\u0275nov"](n,46).ngClassDirty,e["\u0275nov"](n,46).ngClassValid,e["\u0275nov"](n,46).ngClassInvalid,e["\u0275nov"](n,46).ngClassPending,e["\u0275nov"](n,49).ngClassUntouched,e["\u0275nov"](n,49).ngClassTouched,e["\u0275nov"](n,49).ngClassPristine,e["\u0275nov"](n,49).ngClassDirty,e["\u0275nov"](n,49).ngClassValid,e["\u0275nov"](n,49).ngClassInvalid,e["\u0275nov"](n,49).ngClassPending]),l(n,66,0,e["\u0275nov"](n,75).ngClassUntouched,e["\u0275nov"](n,75).ngClassTouched,e["\u0275nov"](n,75).ngClassPristine,e["\u0275nov"](n,75).ngClassDirty,e["\u0275nov"](n,75).ngClassValid,e["\u0275nov"](n,75).ngClassInvalid,e["\u0275nov"](n,75).ngClassPending),l(n,103,0,e["\u0275nov"](n,111).ngClassUntouched,e["\u0275nov"](n,111).ngClassTouched,e["\u0275nov"](n,111).ngClassPristine,e["\u0275nov"](n,111).ngClassDirty,e["\u0275nov"](n,111).ngClassValid,e["\u0275nov"](n,111).ngClassInvalid,e["\u0275nov"](n,111).ngClassPending),l(n,125,0,e["\u0275nov"](n,131).ngClassUntouched,e["\u0275nov"](n,131).ngClassTouched,e["\u0275nov"](n,131).ngClassPristine,e["\u0275nov"](n,131).ngClassDirty,e["\u0275nov"](n,131).ngClassValid,e["\u0275nov"](n,131).ngClassInvalid,e["\u0275nov"](n,131).ngClassPending),l(n,141,0,e["\u0275nov"](n,149).ngClassUntouched,e["\u0275nov"](n,149).ngClassTouched,e["\u0275nov"](n,149).ngClassPristine,e["\u0275nov"](n,149).ngClassDirty,e["\u0275nov"](n,149).ngClassValid,e["\u0275nov"](n,149).ngClassInvalid,e["\u0275nov"](n,149).ngClassPending),l(n,178,0,!t.isFormValid())})}function cl(l){return e["\u0275vid"](0,[e["\u0275pid"](0,i.a,[]),e["\u0275pid"](0,o.DatePipe,[e.LOCALE_ID]),e["\u0275qud"](671088640,1,{rollTable:0}),e["\u0275qud"](402653184,2,{select:0}),(l()(),e["\u0275eld"](4,0,null,null,7,"div",[["class","modal in modal-backdrop"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](6,0,null,null,4,"div",[["class","modal-dialog modal-dialog-centered"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275and"](16777216,null,null,1,null,sl)),e["\u0275did"](9,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){l(n,9,0,n.component.isFetched)},null)}var pl=t("4zOZ"),ml=t("ItHS"),fl=t("7MtV"),hl=t("QTMs"),gl=function(l){this.restDetails=l,this.host=this.restDetails.host,this.machinePlanUrl=this.host+"/machine-plans",this.machinePlanItemFullUrl=this.host+"/machine-plan-items",this.machinePlanItemUrl="machine-plan-items"},vl=(t("/IKm"),t("a/sl")),bl=t("Pj/i"),yl=function(){function l(l,n,t){this.applicationRef=l,this.ngxModalDialogService=n,this.appModalService=t}return l.prototype.openHttpErrorWindow=function(l){var n=Object(bl.a)(l),t=n?n.error:l;return this.appModalService.openHttpErrorModal(this.ngxModalDialogService,this.getRootViewContainerRef(),t),y.a.throw(t)},l.prototype.getRootViewContainerRef=function(){var l=this.applicationRef.components[0].instance;if(!l.viewContainerRef)throw new Error("Missing 'viewContainerRef' declaration in "+this.applicationRef.componentTypes[0].name+" constructor");return l.viewContainerRef},l}(),Cl=function(){function l(l,n,t){this.http=l,this.urlService=n,this.httpErrorService=t}return l.prototype.getAll=function(l){var n=this;return this.http.get(this.urlService.machinePlanUrl+"/"+l+"/"+this.urlService.machinePlanItemUrl,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l.prototype.save=function(l,n){var t=this;return this.http.post(this.urlService.machinePlanUrl+"/"+l+"/"+this.urlService.machinePlanItemUrl,n,{headers:fl.a}).catch(function(l){return t.httpErrorService.openHttpErrorWindow(l)})},l.prototype.update=function(l){var n=this;return this.http.put(this.urlService.machinePlanItemFullUrl+"/"+l.id,l,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l.prototype.delete=function(l){var n=this;return this.http.delete(this.urlService.machinePlanItemFullUrl+"/"+l,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l}(),Tl=function(){function l(l,n,t,e,u,i){this.http=l,this.planItemService=n,this.casheService=t,this.dataService=e,this.urlService=u,this.httpErrorService=i,this.DATE_TIME_FORMAT="DD-MM-YYYY HH:mm:ss"}return l.prototype.getAll=function(l,n){var t=this,e=(new ml.h).set("sort","timeStart").set("machine_number",n.toString()).set("date",Object(q.b)(l));return this.http.get(this.urlService.machinePlanUrl,{params:e,headers:fl.a}).catch(function(l){return t.httpErrorService.openHttpErrorWindow(l)})},l.prototype.getOne=function(l){var n=this;return this.http.get(this.urlService.machinePlanUrl+"/"+l,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l.prototype.save=function(l){var n=this;return this.http.post(this.urlService.machinePlanUrl,l,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l.prototype.update=function(l){var n=this;return this.http.put(this.urlService.machinePlanUrl+"/"+l.id,l,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l.prototype.delete=function(l){var n=this;return this.http.delete(this.urlService.machinePlanUrl+"/"+l,{headers:fl.a}).catch(function(l){return n.httpErrorService.openHttpErrorWindow(l)})},l.prototype.saveWithItems=function(l){var n=this;return this.save(l).flatMap(function(t){return T.Observable.forkJoin(l.planItems.map(function(l){return n.planItemService.save(t.id,l)})).flatMap(function(l){return n.getOne(t.id).map(function(n){return n.planItems=l,n})})})},l.prototype.updateWithItems=function(l,n){var t=this,e=n.planItems.filter(function(l){return!l.id}).map(function(l){return t.planItemService.save(n.id,l)}),u=n.planItems.filter(function(n){return void 0!==l.planItems.find(function(l){return l.id===n.id})}).map(function(l){return t.planItemService.update(l)}),i=l.planItems.filter(function(l){return void 0===n.planItems.find(function(n){return n.id===l.id})}).map(function(l){return t.planItemService.delete(l.id)});return this.update(n).flatMap(function(l){return T.Observable.forkJoin(e.length?T.Observable.forkJoin(e):T.Observable.of([]),u.length?T.Observable.forkJoin(u):T.Observable.of([]),i.length?T.Observable.forkJoin(i):T.Observable.of([])).flatMap(function(n){return t.getOne(l.id).map(function(l){return l.planItems=n[0].concat(n[1]),l})})})},l.prototype.addProductTypes=function(l){var n=this;return l.flatMap(function(l){return 0===l.length?T.Observable.of([]):T.Observable.forkJoin(l.map(function(l){return n.casheService.getProductType(l.productTypeId).map(function(n){return l.productType=n,l})}))})},l.prototype.addItems=function(l){var n=this,t=l.flatMap(function(l){return 0===l.length?T.Observable.of([]):T.Observable.forkJoin(l.map(function(l){return l.planItems?T.Observable.of(l):n.planItemService.getAll(l.id).map(function(n){return l.planItems=n,l})}))});return this.addRollTypes(t)},l.prototype.addRollTypes=function(l){var n=this;return l.flatMap(function(l){return 0===l.length?T.Observable.of([]):T.Observable.forkJoin(l.map(function(l){return T.Observable.forkJoin(l.planItems.map(function(l){return n.casheService.getRollType(l.rollTypeId).map(function(n){return l.rollType=n,l})})).map(function(n){return l.planItems=n,l})}))})},l.prototype.addEmptyPlans=function(l){var n=this;return this.dataService.getCurrentDate().flatMap(function(t){return l.map(function(l){return n._addEmptyPlans(t,l)})})},l.prototype._addEmptyPlans=function(l,n){var t=[],e=C(l).startOf("days").add(8,"hours").format("DD-MM-YYYY HH:mm:SS");if(0===n.length){var u=this.getEmptyPlan(e,24);return t.push(u),t}var i=this.getDiff(null,n[0]);i>0&&(u=this.getEmptyPlan(e,i),t.push(u));for(var o=0;o<n.length;o++){var r=n[o],a=o===n.length-1?null:n[o+1];t.push(n[o]),i=this.getDiff(r,a);var d=this.getFromattedTime(r.timeStart,r.duration);i>0&&(u=this.getEmptyPlan(d,i),t.push(u))}return t},l.prototype.getEmptyPlan=function(l,n){var t=new r;return t.timeStart=l,t.duration=n,t},l.prototype.getDiff=function(l,n){var t=l?C(l.timeStart,this.DATE_TIME_FORMAT).add(l.duration,"hour"):C(n.timeStart,this.DATE_TIME_FORMAT).startOf("days").add(8,"hours"),e=n?C(n.timeStart,this.DATE_TIME_FORMAT):C(l.timeStart,this.DATE_TIME_FORMAT).endOf("days").add(8,"hours");return C.duration(e.diff(t)).asHours()},l.prototype.getFromattedTime=function(l,n){void 0===n&&(n=0);var t=l instanceof Date?C(l):C(l,this.DATE_TIME_FORMAT);return t.add(n,"hours"),t.format(this.DATE_TIME_FORMAT)},l}(),Il=t("jzKN"),Sl=function(){function l(l,n){this.machinePlanService=l,this.dataService=n,this.machinePlansSubject=new pl.a([]),this.machinePlans$=this.machinePlansSubject.asObservable(),this.isMachinePlanFormVisible=!1,this.isTableVisible=!1,this.wasTableOpened=!1,this.isFetched=!1,this.isRemoving=!1,this.ngUnsubscribe=new L.b}return l.prototype.ngOnInit=function(){var l=this;this.dataService.getCurrentDate().flatMap(function(n){return l.machinePlanService.getAll(n,l.machineNumber)}).takeUntil(this.ngUnsubscribe).subscribe(function(n){l.machinePlans=n,l.machinePlansSubject.next(n),l.isFetched=!0}),this.machinePlans$=this.machinePlanService.addProductTypes(this.machinePlans$),this.machinePlansWithItems$=this.machinePlanService.addItems(this.machinePlans$),this.machinePlansWithEmpty$=this.machinePlanService.addEmptyPlans(this.machinePlans$),this.machinePlansWithItemsWithEmpty$=this.machinePlanService.addEmptyPlans(this.machinePlansWithItems$)},l.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},l.prototype.removePlan=function(l){var n=this;this.isRemoving=!0,this.machinePlanService.delete(l.id).subscribe(function(){n.machinePlans=n.machinePlans.filter(function(n){return n!==l}),n.machinePlansSubject.next(n.machinePlans),n.dataService.updateDailyPlan(l,null),n.isRemoving=!1})},l.prototype.submitlMachinePlanForm=function(l){l.id?this.updatePlan(l):this.addPlan(l)},l.prototype.addPlan=function(l){var n=this;this.machinePlanService.saveWithItems(l).subscribe(function(l){n.machinePlans.push(l),n.machinePlans.sort(function(l,n){return Object(Il.b)(l.timeStart,n.timeStart)}),n.machinePlansSubject.next(n.machinePlans),n.dataService.updateDailyPlan(null,l),n.isMachinePlanFormVisible=!1})},l.prototype.updatePlan=function(l){var n=this,t=this.machinePlans.findIndex(function(n){return n.id===l.id}),e=this.machinePlans[t];this.machinePlanService.updateWithItems(e,l).subscribe(function(l){n.machinePlans[t]=l,n.machinePlansSubject.next(n.machinePlans),n.dataService.updateDailyPlan(e,l),n.isMachinePlanFormVisible=!1})},l.prototype.openMachinePlanForm=function(l){this.currentMachinePlan=l,this.isMachinePlanFormVisible=!0},l.prototype.cancelMachinePlanForm=function(){this.isMachinePlanFormVisible=!1},l.prototype.toggleTableVisible=function(){this.isTableVisible||(this.wasTableOpened=!0),this.isTableVisible=!this.isTableVisible},l}(),Pl=e["\u0275crt"]({encapsulation:0,styles:[["#machine-container[_ngcontent-%COMP%]{height:2.5rem}.br-right[_ngcontent-%COMP%]{border-right:1px solid #000}"]],data:{}});function Ol(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"div",[],null,[[null,"dblclick"]],function(l,n,t){var e=!0;return"dblclick"===n&&(e=!1!==l.component.openMachinePlanForm(l.context.index)&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](2,0,null,null,1,"app-machine-plan",[],null,null,null,c,d)),e["\u0275did"](3,114688,null,0,a,[],{plan:[0,"plan"]},null),(l()(),e["\u0275ted"](-1,null,["\n      "]))],function(l,n){l(n,3,0,n.context.$implicit)},null)}function Dl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,20,"div",[["id","machine-container"]],[[8,"hidden",0]],null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](2,0,null,null,17,"div",[["class","row h-100 m-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](4,0,null,null,7,"div",[["class","col-1 d-flex flex-column justify-content-center p-0 br-right"]],null,[[null,"dblclick"]],function(l,n,t){var e=!0;return"dblclick"===n&&(e=!1!==l.component.toggleTableVisible()&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](6,0,null,null,4,"strong",[["class","text-center"],["style","font-size: 1.1rem"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](8,0,null,null,1,"span",[["class","d-none d-md-inline"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0422\u041c-"])),(l()(),e["\u0275ted"](10,null,["","\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](13,0,null,null,5,"div",[["class","col-11 h-100 d-inline-flex p-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275and"](16777216,null,null,2,null,Ol)),e["\u0275did"](16,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),e["\u0275pid"](131072,o.AsyncPipe,[e.ChangeDetectorRef]),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,16,0,e["\u0275unv"](n,16,0,e["\u0275nov"](n,17).transform(t.machinePlansWithEmpty$)))},function(l,n){var t=n.component;l(n,0,0,t.isRemoving),l(n,10,0,t.machineNumber)})}function Rl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,9,"div",[["class","row m-0"]],[[8,"hidden",0]],null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](2,0,null,null,0,"div",[["class","col-1 p-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](4,0,null,null,4,"div",[["class","col-11 pl-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](6,0,null,null,1,"app-machine-table",[],null,[[null,"planRemove"]],function(l,n,t){var e=!0;return"planRemove"===n&&(e=!1!==l.component.removePlan(t)&&e),e},F,P)),e["\u0275did"](7,114688,null,0,S,[I],{machinePlans$:[0,"machinePlans$"]},{planRemove:"planRemove"}),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){l(n,7,0,n.component.machinePlansWithItems$)},function(l,n){var t=n.component;l(n,0,0,!t.isTableVisible||t.isRemoving)})}function Ml(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,9,"div",[["class","row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](2,0,null,null,0,"div",[["class","col-1"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](4,0,null,null,4,"div",[["class","col-11"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](6,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],null,null)}function El(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,5,"div",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](2,0,null,null,2,"app-machine-plan-form",[],null,[[null,"cancel"],[null,"submit"]],function(l,n,t){var e=!0,u=l.component;return"cancel"===n&&(e=!1!==u.cancelMachinePlanForm()&&e),"submit"===n&&(e=!1!==u.submitlMachinePlanForm(t)&&e),e},cl,nl)),e["\u0275did"](3,245760,null,0,ll,[I],{machinePlans$:[0,"machinePlans$"],currentIndex:[1,"currentIndex"],machineNumber:[2,"machineNumber"]},{cancel:"cancel",submit:"submit"}),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,3,0,t.machinePlansWithItemsWithEmpty$,t.currentMachinePlan,t.machineNumber)},null)}function Fl(l){return e["\u0275vid"](0,[(l()(),e["\u0275and"](16777216,null,null,1,null,Dl)),e["\u0275did"](1,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n"])),(l()(),e["\u0275and"](16777216,null,null,1,null,Rl)),e["\u0275did"](4,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n"])),(l()(),e["\u0275and"](16777216,null,null,1,null,Ml)),e["\u0275did"](7,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n\n"])),(l()(),e["\u0275ted"](-1,null,["\n"])),(l()(),e["\u0275and"](16777216,null,null,1,null,El)),e["\u0275did"](11,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null)],function(l,n){var t=n.component;l(n,1,0,t.isFetched),l(n,4,0,t.wasTableOpened),l(n,7,0,t.isRemoving),l(n,11,0,t.isMachinePlanFormVisible)},null)}var _l=function(){function l(){this.hours=Array(24).fill(0).map(function(l,n){return n<16?n+8:n-16})}return l.prototype.ngOnInit=function(){},l}(),wl=e["\u0275crt"]({encapsulation:0,styles:[[".neg-ml-10[_ngcontent-%COMP%]{margin-left:-10%}.neg-ml-18[_ngcontent-%COMP%]{margin-left:-18%}"]],data:{}});function Nl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,6,"small",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\xa0\n    "])),(l()(),e["\u0275eld"](2,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](4,0,null,null,1,"small",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\xa0"])),(l()(),e["\u0275ted"](-1,null,["\n  "]))],null,null)}function Al(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,11,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](2,0,null,null,3,"small",[],null,null,null,null,null)),e["\u0275did"](3,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{ngClass:[0,"ngClass"]},null),e["\u0275pod"](4,{"neg-ml-10":0,"neg-ml-18":1}),(l()(),e["\u0275ted"](5,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](7,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](9,0,null,null,1,"span",[["style","margin-left: -5%; font-size: 0.5rem"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["|"])),(l()(),e["\u0275ted"](-1,null,["\n  "]))],function(l,n){l(n,3,0,l(n,4,0,n.parent.context.$implicit<10,n.parent.context.$implicit>=10))},function(l,n){l(n,5,0,n.parent.context.$implicit)})}function xl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,7,"div",[["class","d-inline-block text-left date-bordered"],["style","background-color: #eee; width: 3.75vw; line-height: 80%"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275and"](16777216,null,null,1,null,Nl)),e["\u0275did"](3,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275and"](16777216,null,null,1,null,Al)),e["\u0275did"](6,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){l(n,3,0,0===n.context.index),l(n,6,0,0!==n.context.index)},null)}function Vl(l){return e["\u0275vid"](0,[(l()(),e["\u0275and"](16777216,null,null,1,null,xl)),e["\u0275did"](1,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null)],function(l,n){l(n,1,0,n.component.hours)},null)}var kl=function(){function l(l,n,t){this.casheService=l,this.dataService=n,this.planService=t}return l.prototype.ngOnInit=function(){this.tableData$=this.fetchTableData()},l.prototype.fetchTableData=function(){var l=this;return this.dataService.getDailyPlan().flatMap(function(n){return T.Observable.forkJoin(n.map(function(n){return l.casheService.getProductType(n.productTypeId).map(function(l){return{plan:n,type:l}})}))})},l.prototype.equalizePlanAmount=function(l){var n=this;this.planService.equalizePlanToMachinePlan(l.productTypeId,l.date).subscribe(function(){return n.dataService.equalizeDailyPlan(l)})},l}(),Ul=e["\u0275crt"]({encapsulation:0,styles:[[".filled-circle[_ngcontent-%COMP%]{padding:0 .5rem;border-width:.04rem;font-size:12px}table.align-middle[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{vertical-align:middle}"]],data:{}});function $l(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](1,null,["- ",""])),e["\u0275ppd"](2,1)],null,function(l,n){l(n,1,0,e["\u0275unv"](n,1,0,l(n,2,0,e["\u0275nov"](n.parent.parent.parent.parent,0),n.parent.parent.context.$implicit)))})}function Ll(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,2,"span",[],null,null,null,null,null)),(l()(),e["\u0275ted"](1,null,["+ ",""])),e["\u0275ppd"](2,1)],null,function(l,n){l(n,1,0,e["\u0275unv"](n,1,0,l(n,2,0,e["\u0275nov"](n.parent.parent.parent.parent,0),-1*n.parent.parent.context.$implicit)))})}function Gl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,9,"button",[["class","btn btn-sm w-100"],["style","font-size: 0.7rem"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.equalizePlanAmount(l.parent.parent.context.$implicit.plan)&&e),e},null,null)),e["\u0275did"](1,278528,null,0,o.NgClass,[e.IterableDiffers,e.KeyValueDiffers,e.ElementRef,e.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e["\u0275pod"](2,{"btn-outline-danger":0,"btn-outline-success":1}),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275and"](16777216,null,null,1,null,$l)),e["\u0275did"](5,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n              "])),(l()(),e["\u0275and"](16777216,null,null,1,null,Ll)),e["\u0275did"](8,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n            "]))],function(l,n){l(n,1,0,"btn btn-sm w-100",l(n,2,0,n.parent.context.$implicit>0,n.parent.context.$implicit<0)),l(n,5,0,n.parent.context.$implicit>0),l(n,8,0,n.parent.context.$implicit<0)},null)}function jl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,4,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275and"](16777216,null,null,1,null,Gl)),e["\u0275did"](3,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),e["\u0275ted"](-1,null,["\n          "]))],function(l,n){l(n,3,0,0!==n.context.$implicit)},null)}function Hl(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](-1,null,["\n            "])),(l()(),e["\u0275eld"](1,0,null,null,1,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,[" 0.000 "])),(l()(),e["\u0275ted"](-1,null,["\n          "]))],null,null)}function Wl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,21,"tr",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](2,0,null,null,1,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](3,null,["",""])),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](5,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275eld"](6,0,null,null,1,"app-product-name",[],null,null,null,b,v)),e["\u0275did"](7,114688,null,0,g,[],{productType:[0,"productType"]},null),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](9,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](10,null,["",""])),e["\u0275ppd"](11,1),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](13,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),e["\u0275ted"](14,null,["",""])),e["\u0275ppd"](15,1),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275and"](16777216,null,null,1,null,jl)),e["\u0275did"](18,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275and"](0,[["zero",2]],null,0,null,Hl)),(l()(),e["\u0275ted"](-1,null,["\n        "]))],function(l,n){l(n,7,0,n.context.$implicit.type),l(n,18,0,n.context.$implicit.plan.manufacturedAmount-n.context.$implicit.plan.productToMachinePlane,e["\u0275nov"](n,20))},function(l,n){l(n,3,0,n.context.index+1),l(n,10,0,e["\u0275unv"](n,10,0,l(n,11,0,e["\u0275nov"](n.parent,0),n.context.$implicit.plan.manufacturedAmount))),l(n,14,0,e["\u0275unv"](n,14,0,l(n,15,0,e["\u0275nov"](n.parent,0),n.context.$implicit.plan.productToMachinePlane)))})}function Yl(l){return e["\u0275vid"](0,[e["\u0275pid"](0,i.a,[]),(l()(),e["\u0275eld"](1,0,null,null,38,"div",[["class","row mt-5"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](3,0,null,null,35,"div",[["class","col-5 d-flex flex-column"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](5,0,null,null,1,"h6",[["class","align-self-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041f\u043b\u0430\u043d \u043f\u043e \u043f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u0438 \u043d\u0430 \u0434\u0435\u043d\u044c"])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](8,0,null,null,29,"table",[["class","table table-sm align-middle"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](10,0,null,null,19,"thead",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](12,0,null,null,16,"tr",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](14,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["#"])),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](17,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041f\u0440\u043e\u0434\u0443\u043a\u0446\u0438\u044f"])),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](20,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041f\u043b\u0430\u043d"])),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](23,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0420\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e"])),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](26,0,null,null,1,"th",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u041e\u0441\u0442\u0430\u0442\u043e\u043a"])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](31,0,null,null,5,"tbody",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275and"](16777216,null,null,2,null,Wl)),e["\u0275did"](34,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),e["\u0275pid"](131072,o.AsyncPipe,[e.ChangeDetectorRef]),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,34,0,e["\u0275unv"](n,34,0,e["\u0275nov"](n,35).transform(t.tableData$)))},null)}var ql=t("lnHF"),zl=function(){function l(l,n,t,e,u){this.standardService=l,this.productPlanSerivce=n,this.casheService=t,this.dataService=e,this.httpErrorService=u,this.machinesAmount=3,this.isFetched=!1,this.machines=Array(this.machinesAmount).fill(0).map(function(l,n){return n+1})}return l.prototype.ngOnInit=function(){var l=this;this.dataService.getCurrentDate().subscribe(function(n){l.selectedDate=n,l.dateForm=new _.FormGroup({date:new _.FormControl(Object(q.d)(n),[_.Validators.required])})}),this.fetchData()},l.prototype.changeDate=function(l){void 0===l&&(l=0);var n=this.dateForm.value.date;this.selectedDate=0===l?Object(q.e)(n,"YYYY-MM-DD"):C(n,"YYYY-MM-DD").add(l,"days").toDate(),this.dateForm.get("date").setValue(Object(q.d)(this.selectedDate)),this.dataService.setCurrentDate(this.selectedDate),this.fetchData()},l.prototype.fetchData=function(){var l=this;this.isFetched=!1,this.productPlanSerivce.getBatches(Object(q.c)(this.selectedDate)).map(function(l){return l.filter(function(l){return 0!==l.manufacturedAmount})}).do(function(n){return l.dataService.setDailyPlan(n)}).flatMap(function(n){return T.Observable.forkJoin(l.fetchDailyStandards(n),l.fetchDailyProductPlans(n))}).catch(function(n){return l.httpErrorService.openHttpErrorWindow(n)}).subscribe(function(){return l.isFetched=!0})},l.prototype.fetchDailyStandards=function(l){var n=this;return 0===l.length?T.Observable.of([]):T.Observable.forkJoin(l.map(function(l){return n.standardService.getStandard(l.productTypeId)})).do(function(l){return n.dataService.setStandards(l)})},l.prototype.fetchDailyProductPlans=function(l){var n=this;return 0===l.length?T.Observable.of([]).do(function(){return n.dataService.setDailyProductTypes([])}):T.Observable.forkJoin(l.map(function(l){return n.casheService.getProductType(l.productTypeId)})).map(function(l){return l.sort(Il.d)}).do(function(l){return n.dataService.setDailyProductTypes(l)})},l}(),Jl=e["\u0275crt"]({encapsulation:0,styles:[[".no-borders[_ngcontent-%COMP%]{border:none}"]],data:{}});function Bl(l){return e["\u0275vid"](0,[(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](1,0,null,null,7,"div",[["class","row"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](3,0,null,null,4,"div",[["class","col-12"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](5,0,null,null,1,"p",[["class","text-center"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n  "]))],null,null)}function Kl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,7,"div",[["class","row mt-2 flex-nowrap"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](2,0,null,null,4,"div",[["class","col-12 m-0 p-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](4,0,null,null,1,"app-machine",[],null,null,null,Fl,Pl)),e["\u0275did"](5,245760,null,0,Sl,[Tl,I],{machineNumber:[0,"machineNumber"]},null),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "]))],function(l,n){l(n,5,0,n.context.$implicit)},null)}function Xl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,26,"div",[],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](2,0,null,null,9,"div",[["class","row mt-2 flex-nowrap"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](4,0,null,null,0,"div",[["class","col-1 p-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](6,0,null,null,4,"div",[["class","col-11 m-0 p-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](8,0,null,null,1,"app-time-line",[],null,null,null,Vl,wl)),e["\u0275did"](9,114688,null,0,_l,[],null,null),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275and"](16777216,null,null,1,null,Kl)),e["\u0275did"](14,802816,null,0,o.NgForOf,[e.ViewContainerRef,e.TemplateRef,e.IterableDiffers],{ngForOf:[0,"ngForOf"]},null),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](16,0,null,null,9,"div",[["class","row m-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](18,0,null,null,0,"div",[["class","col-1 p-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](20,0,null,null,4,"div",[["class","col-11 pl-0"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](22,0,null,null,1,"app-daily-plan-table",[],null,null,null,Yl,Ul)),e["\u0275did"](23,114688,null,0,kl,[W,I,Y.a],null,null),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,9,0),l(n,14,0,t.machines),l(n,23,0)},null)}function Zl(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,41,"div",[["class","container-fluid"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275eld"](2,0,null,null,33,"div",[["class","row mt-1"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275eld"](4,0,null,null,30,"div",[["class","col-12 d-flex flex-column"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275eld"](6,0,null,null,27,"form",[["class","form-inline align-self-center mr-2 pb-2"],["novalidate",""],["style","border-bottom: 2px solid #ddd"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"submit"],[null,"reset"]],function(l,n,t){var u=!0;return"submit"===n&&(u=!1!==e["\u0275nov"](l,8).onSubmit(t)&&u),"reset"===n&&(u=!1!==e["\u0275nov"](l,8).onReset()&&u),u},null,null)),e["\u0275did"](7,16384,null,0,_["\u0275bf"],[],null,null),e["\u0275did"](8,540672,null,0,_.FormGroupDirective,[[8,null],[8,null]],{form:[0,"form"]},null),e["\u0275prd"](2048,null,_.ControlContainer,null,[_.FormGroupDirective]),e["\u0275did"](10,16384,null,0,_.NgControlStatusGroup,[_.ControlContainer],null,null),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](12,0,null,null,4,"button",[["class","btn btn-outline-secondary btn-sm no-borders px-0 mr-1"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.changeDate(-1)&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](14,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["keyboard_arrow_left"])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](18,0,null,null,5,"input",[["class","form-control form-control-sm"],["formControlName","date"],["type","date"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(l,n,t){var u=!0;return"input"===n&&(u=!1!==e["\u0275nov"](l,19)._handleInput(t.target.value)&&u),"blur"===n&&(u=!1!==e["\u0275nov"](l,19).onTouched()&&u),"compositionstart"===n&&(u=!1!==e["\u0275nov"](l,19)._compositionStart()&&u),"compositionend"===n&&(u=!1!==e["\u0275nov"](l,19)._compositionEnd(t.target.value)&&u),u},null,null)),e["\u0275did"](19,16384,null,0,_.DefaultValueAccessor,[e.Renderer2,e.ElementRef,[2,_.COMPOSITION_BUFFER_MODE]],null,null),e["\u0275prd"](1024,null,_.NG_VALUE_ACCESSOR,function(l){return[l]},[_.DefaultValueAccessor]),e["\u0275did"](21,671744,null,0,_.FormControlName,[[3,_.ControlContainer],[8,null],[8,null],[2,_.NG_VALUE_ACCESSOR]],{name:[0,"name"]},null),e["\u0275prd"](2048,null,_.NgControl,null,[_.FormControlName]),e["\u0275did"](23,16384,null,0,_.NgControlStatus,[_.NgControl],null,null),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](25,0,null,null,4,"button",[["class","btn btn-outline-secondary btn-sm px-0 no-borders mr-2 ml-1"]],null,[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.changeDate(1)&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\n          "])),(l()(),e["\u0275eld"](27,0,null,null,1,"i",[["class","material-icons"]],null,null,null,null,null)),(l()(),e["\u0275ted"](-1,null,["keyboard_arrow_right"])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275ted"](-1,null,["\n        "])),(l()(),e["\u0275eld"](31,0,null,null,1,"button",[["class","btn btn-outline-dark btn-sm"]],[[8,"disabled",0]],[[null,"click"]],function(l,n,t){var e=!0;return"click"===n&&(e=!1!==l.component.changeDate()&&e),e},null,null)),(l()(),e["\u0275ted"](-1,null,["\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"])),(l()(),e["\u0275ted"](-1,null,["\n      "])),(l()(),e["\u0275ted"](-1,null,["\n    "])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275and"](0,[["loading",2]],null,0,null,Bl)),(l()(),e["\u0275ted"](-1,null,["\n  "])),(l()(),e["\u0275and"](16777216,null,null,1,null,Xl)),e["\u0275did"](40,16384,null,0,o.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(l()(),e["\u0275ted"](-1,null,["\n"]))],function(l,n){var t=n.component;l(n,8,0,t.dateForm),l(n,21,0,"date"),l(n,40,0,t.isFetched,e["\u0275nov"](n,37))},function(l,n){var t=n.component;l(n,6,0,e["\u0275nov"](n,10).ngClassUntouched,e["\u0275nov"](n,10).ngClassTouched,e["\u0275nov"](n,10).ngClassPristine,e["\u0275nov"](n,10).ngClassDirty,e["\u0275nov"](n,10).ngClassValid,e["\u0275nov"](n,10).ngClassInvalid,e["\u0275nov"](n,10).ngClassPending),l(n,18,0,e["\u0275nov"](n,23).ngClassUntouched,e["\u0275nov"](n,23).ngClassTouched,e["\u0275nov"](n,23).ngClassPristine,e["\u0275nov"](n,23).ngClassDirty,e["\u0275nov"](n,23).ngClassValid,e["\u0275nov"](n,23).ngClassInvalid,e["\u0275nov"](n,23).ngClassPending),l(n,31,0,t.dateForm.invalid)})}var Ql=e["\u0275ccf"]("app-machines-page",zl,function(l){return e["\u0275vid"](0,[(l()(),e["\u0275eld"](0,0,null,null,1,"app-machines-page",[],null,null,null,Zl,Jl)),e["\u0275did"](1,114688,null,0,zl,[ql.a,Y.a,W,I,yl],null,null)],function(l,n){l(n,1,0)},null)},{},{},[]),ln=t("aeH6"),nn=t("KaNj"),tn=t("rAq4"),en=t("JcIz"),un=t("B5Dm"),on=t("oJUu"),rn=t("9Sd6"),an=t("XHgV"),dn=t("1T37"),sn=t("+j5Y"),cn=t("6HX5"),pn=t("zXN4"),mn=t("MyMp"),fn=t("a6ku"),hn=t("bfOx"),gn=function(){},vn=t("bkcK"),bn=t("hIM1"),yn=t("qJ43"),Cn=t("Kz8h"),Tn=t("3LFY"),In=t("puQm"),Sn=t("xX4F");t.d(n,"MachinesModuleNgFactory",function(){return Pn});var Pn=e["\u0275cmf"](u,[],function(l){return e["\u0275mod"]([e["\u0275mpd"](512,e.ComponentFactoryResolver,e["\u0275CodegenComponentFactoryResolver"],[[8,[Ql,ln.a,nn.a,tn.a,en.a,un.a,on.a]],[3,e.ComponentFactoryResolver],e.NgModuleRef]),e["\u0275mpd"](4608,o.NgLocalization,o.NgLocaleLocalization,[e.LOCALE_ID,[2,o["\u0275a"]]]),e["\u0275mpd"](4608,_["\u0275i"],_["\u0275i"],[]),e["\u0275mpd"](4608,_.FormBuilder,_.FormBuilder,[]),e["\u0275mpd"](4608,N.k,N.k,[]),e["\u0275mpd"](4608,N.i,N.i,[]),e["\u0275mpd"](4608,N.h,N.h,[]),e["\u0275mpd"](6144,rn.b,null,[o.DOCUMENT]),e["\u0275mpd"](4608,rn.c,rn.c,[[2,rn.b]]),e["\u0275mpd"](4608,an.a,an.a,[]),e["\u0275mpd"](5120,dn.c,dn.a,[[3,dn.c],e.NgZone,an.a]),e["\u0275mpd"](5120,dn.f,dn.e,[[3,dn.f],an.a,e.NgZone]),e["\u0275mpd"](4608,sn.f,sn.f,[dn.c,dn.f,e.NgZone,o.DOCUMENT]),e["\u0275mpd"](5120,sn.b,sn.g,[[3,sn.b],o.DOCUMENT]),e["\u0275mpd"](4608,sn.e,sn.e,[dn.f,o.DOCUMENT]),e["\u0275mpd"](5120,sn.c,sn.j,[[3,sn.c],o.DOCUMENT]),e["\u0275mpd"](4608,sn.a,sn.a,[sn.f,sn.b,e.ComponentFactoryResolver,sn.e,sn.c,e.ApplicationRef,e.Injector,e.NgZone,o.DOCUMENT]),e["\u0275mpd"](5120,sn.h,sn.i,[sn.a]),e["\u0275mpd"](4608,cn.a,cn.a,[]),e["\u0275mpd"](4608,pn.a,pn.a,[e.ComponentFactoryResolver,cn.a]),e["\u0275mpd"](4608,mn.a,mn.a,[sn.a,sn.f]),e["\u0275mpd"](4608,gl,gl,[hl.a]),e["\u0275mpd"](4608,yl,yl,[e.ApplicationRef,pn.a,vl.a]),e["\u0275mpd"](4608,Cl,Cl,[ml.c,gl,yl]),e["\u0275mpd"](4608,H.a,H.a,[fn.a,ml.c]),e["\u0275mpd"](4608,W,W,[H.a,j.a]),e["\u0275mpd"](4608,I,I,[]),e["\u0275mpd"](4608,Tl,Tl,[ml.c,Cl,W,I,gl,yl]),e["\u0275mpd"](512,o.CommonModule,o.CommonModule,[]),e["\u0275mpd"](512,hn.n,hn.n,[[2,hn.s],[2,hn.k]]),e["\u0275mpd"](512,gn,gn,[]),e["\u0275mpd"](512,_["\u0275ba"],_["\u0275ba"],[]),e["\u0275mpd"](512,_.FormsModule,_.FormsModule,[]),e["\u0275mpd"](512,_.ReactiveFormsModule,_.ReactiveFormsModule,[]),e["\u0275mpd"](512,N.c,N.c,[]),e["\u0275mpd"](512,rn.a,rn.a,[]),e["\u0275mpd"](512,vn.c,vn.c,[]),e["\u0275mpd"](512,an.b,an.b,[]),e["\u0275mpd"](512,dn.b,dn.b,[]),e["\u0275mpd"](512,sn.d,sn.d,[]),e["\u0275mpd"](512,bn.a,bn.a,[]),e["\u0275mpd"](512,yn.a,yn.a,[]),e["\u0275mpd"](512,Cn.a,Cn.a,[]),e["\u0275mpd"](512,Tn.NgSlimScrollModule,Tn.NgSlimScrollModule,[]),e["\u0275mpd"](512,In.NgDatepickerModule,In.NgDatepickerModule,[]),e["\u0275mpd"](512,u,u,[]),e["\u0275mpd"](1024,hn.i,function(){return[[{path:"",component:zl}]]},[]),e["\u0275mpd"](256,N.a,{notFoundText:"No items found",typeToSearchText:"Type to search",addTagText:"Add item",loadingText:"Loading...",clearAllText:"Clear all",disableVirtualScroll:!1},[]),e["\u0275mpd"](256,Sn.a,{useBootstrap4:!0},[])])})}});